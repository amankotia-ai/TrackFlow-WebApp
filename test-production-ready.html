<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TrackFlow - Production Ready Test</title>
  
  <!-- TrackFlow Integration - PRODUCTION READY -->
  <!-- Step 1: Anti-flicker script (prevents flash of original content) -->
  <script src="https://trackflow-webapp-production.up.railway.app/api/anti-flicker.js"></script>
  
  <!-- Step 2: Main TrackFlow system (tracking + workflows) -->
  <script src="https://trackflow-webapp-production.up.railway.app/api/unified-workflow-system.js"></script>
  
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      color: #333;
    }
    
    .container {
      background: white;
      border-radius: 15px;
      padding: 40px;
      box-shadow: 0 20px 40px rgba(0,0,0,0.1);
    }
    
    .header {
      text-align: center;
      margin-bottom: 40px;
    }
    
    .header h1 {
      background: linear-gradient(45deg, #667eea, #764ba2);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      font-size: 2.5em;
      margin: 0;
    }
    
    .status {
      background: #f8f9fa;
      border: 1px solid #dee2e6;
      border-radius: 8px;
      padding: 15px;
      margin: 20px 0;
      font-family: 'Courier New', monospace;
      font-size: 14px;
    }
    
    .status.success { 
      background: #d4edda; 
      border-color: #c3e6cb; 
      color: #155724; 
    }
    
    .status.error { 
      background: #f8d7da; 
      border-color: #f5c6cb; 
      color: #721c24; 
    }
    
    .test-elements {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
      margin: 30px 0;
    }
    
    .test-card {
      background: #f8f9fa;
      border-radius: 10px;
      padding: 20px;
      border: 1px solid #e9ecef;
    }
    
    .test-card h3 {
      margin-top: 0;
      color: #495057;
    }
    
    .cta-button {
      background: linear-gradient(45deg, #667eea, #764ba2);
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 600;
      transition: all 0.3s ease;
    }
    
    .cta-button:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
    }
    
    .hero-headline {
      font-size: 1.5em;
      color: #495057;
      margin: 15px 0;
    }
    
    .log-container {
      background: #1a1a1a;
      color: #00ff00;
      border-radius: 8px;
      padding: 20px;
      font-family: 'Courier New', monospace;
      font-size: 12px;
      max-height: 300px;
      overflow-y: auto;
      margin-top: 20px;
    }
    
    .metric {
      display: inline-block;
      background: #e9ecef;
      padding: 8px 12px;
      border-radius: 4px;
      margin: 5px;
      font-weight: 600;
    }
    
    .special-offer {
      background: linear-gradient(45deg, #ff6b6b, #ee5a6f);
      color: white;
      padding: 20px;
      border-radius: 10px;
      text-align: center;
      display: none;
    }
  </style>
</head>

<body>
  <div class="container">
    <div class="header">
      <h1>üéØ TrackFlow</h1>
      <p>Production Ready Analytics & Workflow System</p>
    </div>
    
    <!-- System Status -->
    <div id="system-status" class="status">
      üîÑ Initializing TrackFlow system...
    </div>
    
    <!-- Test Elements for Workflow Triggers -->
    <div class="test-elements">
      <div class="test-card">
        <h3>üì± Mobile Optimization</h3>
        <p class="hero-headline">Click to Get Started</p>
        <button class="cta-button">Click to Get Started</button>
        <p><small>On mobile devices, this should change to "Tap to Start"</small></p>
      </div>
      
      <div class="test-card">
        <h3>üéØ UTM Tracking</h3>
        <p>Add UTM parameters to test personalization:</p>
        <div>
          <a href="?utm_source=google" style="color: #667eea;">Test Google Traffic</a><br>
          <a href="?utm_source=facebook" style="color: #667eea;">Test Facebook Traffic</a><br>
          <a href="?utm_source=email" style="color: #667eea;">Test Email Traffic</a>
        </div>
      </div>
      
      <div class="test-card">
        <h3>üìä Form Submission</h3>
        <form id="test-form">
          <input type="email" placeholder="Enter your email" required style="width: 100%; padding: 10px; margin: 10px 0; border: 1px solid #ddd; border-radius: 4px;">
          <button type="submit" class="cta-button">Subscribe</button>
        </form>
      </div>
      
      <div class="test-card">
        <h3>üéÅ Special Offer (Hidden)</h3>
        <div class="special-offer" id="special-offer">
          üéâ Limited Time Offer!<br>
          Get 50% off your first order!
        </div>
        <p><small>This appears when triggered by workflow</small></p>
      </div>
    </div>
    
    <!-- Analytics Metrics -->
    <div style="text-align: center; margin: 30px 0;">
      <h3>üìà Live Analytics</h3>
      <div id="analytics-metrics">
        <span class="metric">Session: <span id="session-id">Loading...</span></span>
        <span class="metric">Device: <span id="device-type">Loading...</span></span>
        <span class="metric">Events: <span id="event-count">0</span></span>
        <span class="metric">Page Views: <span id="page-views">0</span></span>
      </div>
    </div>
    
    <!-- Live Console Log -->
    <h3>üìã System Log</h3>
    <div class="log-container" id="console-log">
      Waiting for TrackFlow to initialize...
    </div>
  </div>

  <script>
    // Console log interceptor to show logs on page
    const originalLog = console.log;
    const logContainer = document.getElementById('console-log');
    let eventCount = 0;
    let pageViews = 0;
    
    function addToLog(message) {
      const timestamp = new Date().toLocaleTimeString();
      logContainer.innerHTML += `<div>[${timestamp}] ${message}</div>`;
      logContainer.scrollTop = logContainer.scrollHeight;
    }
    
    // Override console.log to capture TrackFlow messages
    console.log = function(...args) {
      originalLog.apply(console, args);
      const message = args.join(' ');
      if (message.includes('üéØ') || message.includes('üìä') || message.includes('‚úÖ')) {
        addToLog(message);
      }
    };
    
    // Track system initialization
    document.addEventListener('DOMContentLoaded', function() {
      addToLog('üéØ DOM loaded, waiting for TrackFlow...');
      
      // Check if TrackFlow is ready every 100ms
      const checkInterval = setInterval(() => {
        if (window.elementTracker && window.workflowSystem) {
          clearInterval(checkInterval);
          
          document.getElementById('system-status').innerHTML = '‚úÖ TrackFlow system ready!';
          document.getElementById('system-status').className = 'status success';
          
          // Update metrics
          if (window.elementTracker.sessionId) {
            document.getElementById('session-id').textContent = window.elementTracker.sessionId.substring(0, 8) + '...';
          }
          
          const deviceType = window.innerWidth > 768 ? 'Desktop' : 'Mobile';
          document.getElementById('device-type').textContent = deviceType;
          
          addToLog('‚úÖ TrackFlow fully initialized and ready!');
          
          // Set up event listeners for demo
          setupDemoEventListeners();
        }
      }, 100);
      
      // Timeout after 10 seconds
      setTimeout(() => {
        if (!window.elementTracker || !window.workflowSystem) {
          clearInterval(checkInterval);
          document.getElementById('system-status').innerHTML = '‚ùå TrackFlow failed to load';
          document.getElementById('system-status').className = 'status error';
          addToLog('‚ùå TrackFlow initialization timeout');
        }
      }, 10000);
    });
    
    function setupDemoEventListeners() {
      // Track form submissions
      document.getElementById('test-form').addEventListener('submit', function(e) {
        e.preventDefault();
        eventCount++;
        document.getElementById('event-count').textContent = eventCount;
        addToLog('üìù Form submission tracked');
        
        // Show success message
        alert('Form submitted! Check the analytics dashboard for tracking data.');
      });
      
      // Track button clicks
      document.querySelectorAll('.cta-button').forEach(button => {
        button.addEventListener('click', function() {
          if (!this.closest('form')) { // Don't double-track form buttons
            eventCount++;
            document.getElementById('event-count').textContent = eventCount;
            addToLog('üñ±Ô∏è Button click tracked: ' + this.textContent);
          }
        });
      });
      
      // Update page view count
      pageViews = 1;
      document.getElementById('page-views').textContent = pageViews;
      
      addToLog('üéÆ Demo event listeners set up');
    }
    
    // Test manual workflow trigger
    function testWorkflowTrigger() {
      if (window.workflowSystem) {
        window.workflowSystem.testTrigger('mobile-cta-optimization');
        addToLog('üß™ Manual workflow trigger test');
      }
    }
    
    // Add test button for manual triggers
    setTimeout(() => {
      if (window.workflowSystem) {
        const testButton = document.createElement('button');
        testButton.textContent = 'üß™ Test Workflow';
        testButton.className = 'cta-button';
        testButton.onclick = testWorkflowTrigger;
        testButton.style.marginTop = '10px';
        document.querySelector('.container').appendChild(testButton);
      }
    }, 2000);
  </script>
</body>
</html> 